(function(e){function t(t){for(var i,r,o=t[0],c=t[1],u=t[2],d=0,l=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&l.push(a[r][0]),a[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);p&&p(t);while(l.length)l.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},a={app:0},s=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/vmod-texteditor-demo/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var p=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"3c9c":function(e,t,n){"use strict";var i=n("e16b"),a=n.n(i);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("7db0"),n("c740"),n("d81d"),n("a434"),n("b0c0"),n("d3b7"),n("96cf");var i=n("1da1"),a=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),s=n("2f62");n("fb6a"),n("25f0");function r(){return Math.random().toString(16).slice(2)}function o(e){return new Promise((function(t){console.log("ajax call categories",e.map((function(e){return e.id}))),t({success:!0,message:null})}))}function c(e){return new Promise((function(t){setTimeout((function(){console.log("ajax call add category",{name:e}),t({success:!0,message:{category:{id:r(),name:e}}})}),1e3)}))}function u(e){return new Promise((function(t){setTimeout((function(){console.log("ajax call update category",e),t({success:!0,message:null})}),1e3)}))}function p(e){return new Promise((function(t){setTimeout((function(){console.log("ajax call delete category",e),t({success:!0,message:null})}),1e3)}))}function d(e){return new Promise((function(t){console.log("ajax call snippets",e.map((function(e){return{id:e.id,category_id:e.category_id,position:e.position}}))),t({success:!0,message:null})}))}function l(e){return new Promise((function(t){setTimeout((function(){console.log("ajax call save snippet",{id:e.id,title:e.title,contents:e.contents}),t({success:!0,message:null})}),1e3)}))}function g(){return new Promise((function(e){setTimeout((function(){console.log("ajax call get empty snippet"),e({success:!0,message:{snippet:{id:r(),title:"",category_id:0,position:1e3,contents:[{language_id:1,content:""},{language_id:2,content:""},{language_id:3,content:""}]}}})}),1e3)}))}function m(e){return new Promise((function(t){setTimeout((function(){console.log("ajax call delete snippet",e),t({success:!0,message:null})}),1e3)}))}function f(){return new Promise((function(e){var t={success:!0,message:{languages:[{id:1,name:"Français"},{id:2,name:"Anglais"},{id:3,name:"Allemand"},{id:4,name:"Breton"}],categories:[{id:1,name:"Client fâchés"},{id:2,name:"Client content"},{id:3,name:"Client très content"}],snippets:[{id:1,title:"A cause du bruit",category_id:1,position:1,contents:[{language_id:1,content:"Lorem ipsum en francais"},{language_id:2,content:"Lorem ipsum en anglais"},{language_id:3,content:"Lorem ipsum en allemand"}]},{id:2,title:"A cause du staff",category_id:1,position:2,contents:[{language_id:1,content:"Toute notre équipe vous présente ses plus plates excuses"},{language_id:2,content:"All the team is truly sorry and is being whipped right now"},{language_id:3,content:"Lorem ipsum en allemand"}]},{id:3,title:"Remercie le staff",category_id:2,position:1,contents:[{language_id:1,content:"Merci mreci mreci"},{language_id:2,content:"thanks thanks thanks"},{language_id:3,content:"Lorem ipsum en allemand"}]},{id:4,title:"Remercie le staff 2",category_id:2,position:2,contents:[{language_id:1,content:"Merci mreci mreci"},{language_id:2,content:"thanks thanks thanks"},{language_id:3,content:"Lorem ipsum en allemand"}]},{id:5,title:"Excellent",category_id:3,position:1,contents:[{language_id:1,content:"Lorem ipsum en francais"},{language_id:2,content:"Lorem ipsum en anglais"},{language_id:3,content:"Lorem ipsum en allemand"}]}]}};e(t)}))}var h={load:f,saveCategoriesPosition:o,addCategory:c,updateCategory:u,deleteCategory:p,saveSnippetsPosition:d,saveSnippet:l,getEmptySnippet:g,deleteSnippet:m},v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container reputation-snippet-editor"},[n("div",{staticClass:"header mb-1"},[n("h4",{staticClass:"box-title"},[e._v(" "+e._s(e.__("Catégorie"))+" ")]),n("button",{staticClass:"btn btn-link",on:{click:e.addCategory}},[e._v(" "+e._s(e.__("+ Ajouter une catégorie"))+" ")])]),n("Loader",{attrs:{loading:e.loading}},[n("draggable",e._b({model:{value:e.categories,callback:function(t){e.categories=t},expression:"categories"}},"draggable",e.dragOptions,!1),e._l(e.categories,(function(e){return n("SnippetCategory",{key:e.id,attrs:{category:e}})})),1)],1)],1)},_=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box-xxl-less shadow-lg mb-0 snippet-category"},[n("div",{staticClass:"header pb-2"},[e._m(0),n("h6",{staticClass:"pl-2 mb-0"},[n("strong",[e._v(e._s(e.__(e.category.name)))])]),n("button",{staticClass:"btn btn-link p-2",on:{click:e.updateCategory}},[n("i",{staticClass:"fas fa-pen"})]),n("div",{staticClass:" ml-auto"},[e.snippets.length?e._e():n("button",{staticClass:"btn btn-outline-danger ml-2",on:{click:e.deleteCategory}},[e._v(" "+e._s(e.__("Supprimer"))+" ")])])]),n("draggable",e._b({staticClass:"drop-category",model:{value:e.snippets,callback:function(t){e.snippets=t},expression:"snippets"}},"draggable",e.dragOptions,!1),e._l(e.snippets,(function(e){return n("SnippetItem",{key:e.id,attrs:{snippet:e}})})),1),n("button",{staticClass:"btn btn-link mt-2",attrs:{disabled:e.editing},on:{click:e.createSnippet}},[e._v(" "+e._s(e.__("+ Ajouter une réponse"))+" ")]),e.emptySnippet&&e.editing?n("SnippetItemEditor",{attrs:{snippet:e.emptySnippet,create:!0},on:{"snippet-save":e.closeEditor,"close-editor":e.closeEditor}}):e._e()],1)},w=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn btn-link",attrs:{"data-drag-category":""}},[n("i",{staticClass:"fas fa-arrows-alt-v"})])}],y=(n("4de4"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"snippet-item snippet-row mb-2 mt-2 pb-2"},[n("div",{staticClass:"snippet-container"},[n("div",{staticClass:"block-title"},[e._m(0),n("strong",[e._v(e._s(e.snippet.title))])]),n("div",{staticClass:"ml-auto btn-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.editing,expression:"!editing"}],staticClass:"btn-group"},[n("button",{staticClass:"btn btn-outline-danger",on:{click:function(t){return e.deleteSnippet()}}},[n("i",{staticClass:"fas fa-trash"})]),n("button",{staticClass:"btn btn-secondary",on:{click:function(t){e.editing=!e.editing}}},[e._v(" "+e._s(e.__("modifier"))+" ")])])])]),e.editing?n("SnippetItemEditor",{attrs:{snippet:e.snippet},on:{"close-editor":function(t){e.editing=!e.editing}}}):e._e()],1)}),C=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn btn-link mr-1",attrs:{"data-drag-snippet":""}},[n("i",{staticClass:"fas fa-bars"})])}],S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Loader",{attrs:{loading:e.loading}},[n("div",{staticClass:"box-fieldset"},[n("div",{staticClass:"form-group"},[n("span",[e._v(e._s(e.__("Nom")))]),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}})]),n("div",{staticClass:"tab-body "},[n("div",{staticClass:"tab-heading"},[n("nav",[n("div",{staticClass:"nav-tabs nav"},e._l(e.languages,(function(t){return n("a",{key:t.id,staticClass:"nav-item nav-link",class:{active:e.current_language_id===t.id},attrs:{href:"#"},on:{click:[function(n){e.current_language_id=t.id},function(e){e.preventDefault()}]}},[n("span",{staticClass:"name"},[e._v(e._s(t.name))])])})),0)])]),n("div",{staticClass:"tab-content",attrs:{id:"nav-tabContent"}},[n("div",{staticClass:"tab-pane"})])]),e._l(e.languages,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:e.current_language_id===t.id,expression:"current_language_id === language.id"}],key:t.id,staticClass:"form-group"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.contents_hash[t.id],expression:"contents_hash[language.id]"}],staticClass:"form-control",staticStyle:{width:"100%"},attrs:{rows:"4"},domProps:{value:e.contents_hash[t.id]},on:{input:function(n){n.target.composing||e.$set(e.contents_hash,t.id,n.target.value)}}})])})),n("div",{staticClass:"text-right"},[n("button",{staticClass:"btn btn-secondary ml-2",on:{click:e.saveSnippet}},[e._v(" "+e._s(e.__("Enregistrer"))+" ")]),n("button",{staticClass:"btn btn-outline-secondary ml-2",on:{click:e.cancel}},[e._v(" "+e._s(e.__("Annuler"))+" ")])])],2)])},x=[],k=(n("4160"),n("159b"),n("5530")),j={name:"SnippetItemEditor",props:["snippet","create"],data:function(){return{contents_hash:this.freshContentsHash(this.snippet),current_language_id:1,title:this.snippet.title}},computed:Object(k["a"])(Object(k["a"])({},Object(s["b"])(["languages"])),{},{loading:function(){return this.$store.state.loading.saveSnippet}}),methods:{freshContentsHash:function(e){var t={};return e.contents.forEach((function(e){t[e.language_id]=e.content})),this.$store.state.languages.forEach((function(e){e.id in t||(t[e.id]="")})),t},saveSnippet:function(){var e=this;this.$store.dispatch("loading",{event:"saveSnippet",isLoading:!0});var t=[];for(var n in this.contents_hash)t.push({language_id:n,content:this.contents_hash[n]});var i={id:this.snippet.id,title:this.title,contents:t};this.create&&(i={id:this.snippet.id,title:this.title,category_id:this.snippet.category_id,position:this.snippet.position,contents:t}),this.$store.dispatch("saveSnippet",{snippetToSave:i,create:this.create}).then((function(){e.$store.dispatch("loading",{event:"saveSnippet",isLoading:!1}),e.$emit("close-editor")}))},cancel:function(){this.$emit("close-editor")}}},O=j,$=n("2877"),P=Object($["a"])(O,S,x,!1,null,null,null),L=P.exports,E={name:"SnippetItem",props:["snippet"],components:{SnippetItemEditor:L},data:function(){return{editing:!1}},methods:{deleteSnippet:function(){var e=this;window.app.ui.confirm(this.__("Voulez-vous vraiment supprimer ?")).then((function(){e.$store.dispatch("loading",{event:"delSnippet",isLoading:!0}),e.$store.dispatch("deleteSnippet",e.snippet.id).then((function(){e.$store.dispatch("loading",{event:"delSnippet",isLoading:!1})}))}))}}},R=E,T=(n("3c9c"),Object($["a"])(R,y,C,!1,null,"29d474d8",null)),I=T.exports,A=n("1157"),M=n.n(A);window.__=function(e){return e},window.app={ui:{loading:function(e){e?M()("body").addClass("loading"):M()("body").removeClass("loading")},loadingFrame:function(e,t){M()(e)[t?"addClass":"removeClass"]("frame-loading")},confirm:function(e){return new Promise((function(t){var n=window.confirm(e);n&&t()}))},error:function(e){alert("Error !"+String(e))},success:function(){var e='<div class="toaster alert alert-success" role="alert" style="position: fixed; top: 0; left: 50%; margin-left: -50px;">\n          Success\n          </div>',t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t),window.setTimeout((function(){M()(".toaster.alert").fadeTo(200,0).slideUp(200,(function(){M()(this).remove()}))}),500)},prompt:function(e,t){return new Promise((function(n){var i=window.prompt(e,t);i&&n(i)}))}}};var N=n("310e"),F={name:"SnippetCategory",props:["category"],data:function(){return{editing:!1,emptySnippet:null,hasSnippets:!1}},components:{SnippetItem:I,draggable:N,SnippetItemEditor:L},computed:{snippets:{get:function(){var e=this;return this.$store.state.snippets.filter((function(t){return t.category_id===e.category.id})).sort((function(e,t){return e.position-t.position}))},set:function(e){var t=this,n=e.map((function(e,n){return e.category_id=t.category.id,e.position=n+1,e}));this.$store.dispatch("debounceUpdateSnippetsOrder",n)}},dragOptions:function(){return{group:"snippets",animation:150,handle:"[data-drag-snippet]",forceFallback:!0}}},methods:{updateCategory:function(){var e=this;window.app.ui.prompt("Modifier le nom de la catégorie",this.category.name).then((function(t){t&&(e.$store.dispatch("loading",{event:"updateCategory",isLoading:!0}),e.$store.dispatch("updateCategory",{id:e.category.id,name:t}).then((function(){e.$store.dispatch("loading",{event:"updateCategory",isLoading:!1})})))}))},deleteCategory:function(){var e=this;window.app.ui.confirm(this.__("Voulez-vous vraiment supprimer ?")).then((function(){e.$store.dispatch("loading",{event:"delCategory",isLoading:!0}),e.$store.dispatch("deleteCategory",e.category.id).then((function(){e.$store.dispatch("loading",{event:"delCategory",isLoading:!1})}))}))},createSnippet:function(){var e=this;this.$store.dispatch("loading",{event:"createSnippet",isLoading:!0}),this.$store.dispatch("getEmptySnippet").then((function(t){var n=t.message.snippet;n.category_id=e.category.id,n.position=e.snippets.length+1,e.emptySnippet=n,e.editing=!0})).then((function(){e.$store.dispatch("loading",{event:"createSnippet",isLoading:!1})}))},closeEditor:function(){this.editing=!this.editing}}},H=F,U=(n("f308"),Object($["a"])(H,b,w,!1,null,"b395a6d0",null)),z=U.exports,J=n("310e"),V={name:"ReputationSnippetEditor",components:{SnippetCategory:z,draggable:J},computed:{categories:{get:function(){return this.$store.state.categories},set:function(e){this.$store.dispatch("updateCategoryOrder",e)}},loading:function(){var e=this.$store.state.loading;return e.delSnippet||e.addCategory||e.delCategory||e.updateCategory||e.createSnippet},dragOptions:function(){return{animation:150,handle:"[data-drag-category]",forceFallback:!0}}},methods:{addCategory:function(){var e=this;window.app.ui.prompt(this.__("Ajouter une nouvelle catégorie")).then((function(t){e.$store.dispatch("loading",{event:"addCategory",isLoading:!0}),t&&e.$store.dispatch("addCategory",t).then((function(){e.$store.dispatch("loading",{event:"addCategory",isLoading:!1})}))}))}}},q=V,B=(n("b884"),Object($["a"])(q,v,_,!1,null,"22dee025",null)),D=B.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"frame-loading":e.loading}},[e._t("default")],2)},K=[],Q={name:"Loader",props:["loading"]},W=Q,X=Object($["a"])(W,G,K,!1,null,null,null),Y=X.exports,Z=(n("8a71"),n("2ef0"));n("4989");a["a"].use(s["a"]),a["a"].component("Loader",Y),a["a"].mixin({methods:{__:function(e){return e}}}),a["a"].config.productionTip=!1;var ee=te();function te(){var e={categories:[],snippets:[],languages:[],isLoading:!1,loading:{saveSnippet:!1,delSnippet:!1,addCategory:!1,delCategory:!1,updateCategory:!1,createSnippet:!1,el:null}},t={categories:function(e,t){e.categories=t},snippets:function(e,t){e.snippets=t},languages:function(e,t){e.languages=t},add_category:function(e,t){e.categories.unshift(t)},add_snippet:function(e,t){e.snippets.push(t)},delete_category:function(e,t){e.categories.splice(e.categories.findIndex((function(e){return e.id===t})),1)},delete_snippet:function(e,t){e.snippets.splice(e.snippets.findIndex((function(e){return e.id===t})),1)},loading:function(e,t){var n=t.event,i=t.isLoading,a=t.el;e.loading[n]=i,e.loading["el"]=a||null}},n={load:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.abrupt("return",h.load().then((function(e){n("categories",e.message.categories),n("snippets",e.message.snippets),n("languages",e.message.languages)})));case 2:case"end":return t.stop()}}),t)})))()},updateCategoryOrder:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.commit,n.abrupt("return",h.saveCategoriesPosition(t).then((function(e){if(e.success)return i("categories",t),window.app.ui.success(),Promise.resolve();window.app.ui.error(e.message)})));case 2:case"end":return n.stop()}}),n)})))()},addCategory:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.commit,n.abrupt("return",h.addCategory(t).then((function(e){if(e.success)return i("add_category",e.message.category),window.app.ui.success(),Promise.resolve();window.app.ui.error(e.message)})));case 2:case"end":return n.stop()}}),n)})))()},deleteCategory:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.commit,n.abrupt("return",h.deleteCategory(t).then((function(e){if(e.success)return i("delete_category",t),window.app.ui.success(),Promise.resolve();window.app.ui.error(e.message)})));case 2:case"end":return n.stop()}}),n)})))()},updateCategory:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.state,a=e.commit,n.abrupt("return",h.updateCategory(t).then((function(e){if(e.success){var n=i.categories.map((function(e){return e.id===t.id&&(e.name=t.name),e}));return a("categories",n),window.app.ui.success(),Promise.resolve()}window.app.ui.error(e.message)})));case 2:case"end":return n.stop()}}),n)})))()},debounceUpdateSnippetsOrder:Object(Z["debounce"])((function(e,t){var n=e.state,i=e.commit,a=n.snippets.map((function(e){var n=t.find((function(t){return t.id===e.id}));return n&&(e=n),e}));h.saveSnippetsPosition(a).then((function(e){e.success?(i("snippets",a),window.app.ui.success()):window.app.ui.error(e.message)}))}),100),saveSnippet:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i,a,s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.state,a=e.commit,s=t.snippetToSave,r=t.create,n.abrupt("return",h.saveSnippet(s).then((function(e){if(e.success){if(r)a("add_snippet",s);else{var t=i.snippets.map((function(e){return e.id===s.id&&(e.title=s.title,e.contents=s.contents),e}));a("snippets",t)}return window.app.ui.success(),Promise.resolve()}window.app.ui.error(e.message)})));case 3:case"end":return n.stop()}}),n)})))()},getEmptySnippet:function(){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",h.getEmptySnippet().then((function(e){if(e.success)return window.app.ui.success(),Promise.resolve(e);window.app.ui.error(e.message)})));case 1:case"end":return e.stop()}}),e)})))()},deleteSnippet:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.commit,n.abrupt("return",h.deleteSnippet(t).then((function(e){if(e.success)return i("delete_snippet",t),window.app.ui.success(),Promise.resolve();window.app.ui.error(e.message)})));case 2:case"end":return n.stop()}}),n)})))()},loading:function(e,t){var n=e.commit;n("loading",t)}};return new s["a"].Store({state:e,mutations:t,actions:n})}new a["a"]({store:ee,render:function(e){return e(D)}}).$mount("#app"),ee.dispatch("load")},"61cd":function(e,t,n){},"6b9c":function(e,t,n){},"8a71":function(e,t,n){},b884:function(e,t,n){"use strict";var i=n("61cd"),a=n.n(i);a.a},e16b:function(e,t,n){},f308:function(e,t,n){"use strict";var i=n("6b9c"),a=n.n(i);a.a}});
//# sourceMappingURL=app.9b59d74e.js.map